<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro Empresa</title>

    <!-- Linkando O  CSS da tela de dashboard (grafico)-->
    <link rel="stylesheet" href="./css/estilo_Tela_Inicial_Do_Grafico.css">

    <link rel="stylesheet" href="./css/cadastro_empresa.css">

    <!-- linkando os icones-->
    <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css">
    <link rel="shortcut icon" href="./assets/img/favicon-32x32.png" type="image/x-icon" />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="shortcut icon" href="./assets/img/favicon-32x32.png" type="image/x-icon" />
</head>

<body onload="atualizarEmpresa()">

    <!-- Div container do grafico e da navegação -->
    <div class="containerGrafico">
        <!-- Div que contem a parte de navegação (parte verde do menu)-->
        <div class="navegacao">
            <ul>
                <li>
                    <!-- Foto De Perfil do USUARIO e o NOME do mesmo -->
                    <div class="fotoDePerfil">
                        <a href="#">

                            <!-- imagem do ICONE DA FOTO DE PERFIL-->
                            <span class="icone"><i class="uil uil-user"></i> </span>
                            <span class="titulo"><span id="b_usuario">usuário</span></span>

                        </a>
                    </div>
                </li>
                <li>
                    <a href="./tela_Inicial_Do_Grafico.html">

                        <!-- Imagem do ICONE DO planos-->
                        <span class="icone"> <i class="uil uil-home"></i> </span>
                        <span class="titulo"> Início </span>

                    </a>
                </li>
                <li onclick="Adicionar()" id="adicionar2">
                    <a href="#">

                        <!--Imagem do ICONE DE ADICIONAR -->
                        <span class="icone"> <i class="uil uil-plus"></i> </span>
                        <span class="titulo"> Adicionar</span>
                        <span class="icone2"><i class="uil uil-angle-down"></i></span>

                    </a>
                </li>
                <div class="adicionar" id="adicionar3">

                    <li>
                        <a href="./cadastro_armazem.html">

                            <!--Imagem do ICONE DE ADICIONAR -->
                            <span class="icone"> <i class="uil uil-estate"></i> </span>
                            <span class="titulo"> Adicionar Armazem</span>
                        </a>
                    </li>
                    <li>
                        <a href="./cadastro_empresa.html">

                            <!--Imagem do ICONE DE ADICIONAR -->
                            <span class="icone"> <i class="uil uil-building"></i></span>
                            <span class="titulo"> Adicionar Empresa</span>

                        </a>
                    </li>
                    <li>
                        <a href="./cadastro_funcionario.html">

                            <!--Imagem do ICONE DE ADICIONAR -->
                            <span class="icone"> <i class="uil uil-user-plus"></i> </span>
                            <span class="titulo"> Adicionar Responsável</span>

                        </a>
                    </li>
                </div>
                <li>
                    <a href="./configuracoes.html">

                        <!-- Imagem do ICONE DE CONFIGURAÇÕES -->
                        <span class="icone"><i class="uil uil-cog"></i></span>
                        <span class="titulo"> Configurações</span>

                    </a>
                </li>
                <li>
                    <a href="http://suporteMelvs.auvo.com.br">

                        <!-- Imagem do ICONE DE SUPORTE -->
                        <span class="icone"><i class="uil uil-comment-question"></i>
                        </span>
                        <span class="titulo"> Suporte</span>

                    </a>
                </li>
                <li>
                    <a href="#" class="Modo" onclick="ModoClaro()">

                        <!-- Dark Mode -->
                        <span class="icone"><i class="uil uil-moon"></i> </span>
                        <span id="ModoEscuro" class="Modo"> Modo Escuro </span>

                    </a>
                </li>
                <li>
                    <a href="./index.html">

                        <!-- Botão de Sair  -->
                        <span class="icone"><i class="uil uil-signout"></i> </span>
                        <span class="titulo"> Sair </span>

                    </a>
                </li>

            </ul>
        </div>
    </div>
</body>

<!-- **************************************************************************************** -->

<!--Menu-->

<div class="menu">

    <!-- Parte de Cima que contem A logo de Melvs e O botão de ocutar o menu-->
    <div class="barra-de-cima">

        <!-- Div Que tem o icone de Menu-->
        <div class="toggle">

            <!-- Imagem do ICONE DE MENU -->
            <i class="uil uil-list-ul"></i>

        </div>

        <!-- Div que contem A LOGO DA MELVIS -->
        <div>
            <!-- Imagem da logo da MELVS VERDE -->
            <img src="./assets/img/melvs_logo.png" alt="">

        </div>

        <div>

        </div>

    </div>

    <!-- **************************************************************************************** -->

    <div class="add_emp">
        <div class="lista_emp">
            <h1 class="titulo_empresa">Empresas</h1>

            <dialog class="dialogzinho">

                <div class="dialog">

                    <div class="header">
                        <h2>Cadastrar Empresa</h2>
                        <i class="uil uil-times-circle" onclick='fechar()'></i>
                    </div>
                    <div id="form" class="form">
                        <div class="containerInput">
                            <input class="input margin" placeholder="Nome Fantasia" id="input_nome_empresa">
                        </div>
                        <div class="containerInput">
                            <input class="input margin" placeholder="CNPJ" id="input_cnpj_empresa"
                                maxlength="14" onkeyup="cnpjPontos()">
                        </div>
                        <div class="cep-cidade">
                            <div class="containerInput">
                                <input class="input margin" placeholder="CEP" id="input_cep_empresa" maxlength="8"
                                onkeyup="cepPontos()">
                                <i class="fas fa-check-circle"></i>
                                <i class="fas fa-exclamation-circle"></i>
                            </div>
                            <div class="containerInput">
                                <input class="input margin" placeholder="Cidade" id="input_cidade_empresa">
                            </div>
                            <div class="containerInput">
                                <input class="input margin" placeholder="Complemento" id="input_complemento_empresa">
                            </div>
                        </div>
                        <div class="containerInput">
                            <select id="input_estado_empresa" class="input margin">
                                <option value="">Escolha um estado</option>
                                <option value="ac">Acre</option>
                                <option value="al">Alagoas</option>
                                <option value="ap">Amapa</option>
                                <option value="am">Amazonas</option>
                                <option value="ba">Bahia</option>
                                <option value="ce">Ceara</option>
                                <option value="df">Distrito Federal</option>
                                <option value="es">Espirito Santo</option>
                                <option value="go">Goiás</option>
                                <option value="ma">Maranhão </option>
                                <option value="mt">Mato Grosso</option>
                                <option value="ms">Mato Grosso do Sul</option>
                                <option value="mg">Minas Gerais</option>
                                <option value="pa">Pará</option>
                                <option value="pb">Paraíba</option>
                                <option value="pr">Paraná</option>
                                <option value="pe">Pernambuco</option>
                                <option value="pi">Piauí</option>
                                <option value="rj">Rio de Janeiro</option>
                                <option value="rn">Rio Grande do Norte</option>
                                <option value="rs">Rio Grande do Sul</option>
                                <option value="ro">Rondônia</option>
                                <option value="rr">Roraima</option>
                                <option value="sc">Santa Catarina</option>
                                <option value="sp">São Paulo</option>
                                <option value="se">Sergipe</option>
                                <option value="to">tocantins</option>
                            </select>
                        </div>

                        <!-- Container input-->
                        <button onclick='cadastrarEmpresa()' class="input margin">Cadastrar</button>
                    </div> <!-- formulario -->
                </div> <!-- div - menu -->
            </dialog>
        </div>

    </div> <!-- div - menu -->
    <div class="listaConteudo">
        <div class="cadastrar">
            <button onclick="modal()"><i class="uil uil-building"></i>     Cadastrar Empresa</button>
        </div>
        <ul id="listaEmpresa">
        </ul>
    </div>

</div>

</html>

<!-- SCRIPT  SCRIPT  SCRIPT  SCRIPT  SCRIPT  SCRIPT  SCRIPT  SCRIPT  SCRIPT  SCRIPT  SCRIPT  SCRIPT  SCRIPT  SCRIPT  SCRIPT  -->


<!-- MENU MENU MENU MENU MENU MENU MENU MENU MENU MENU MENU MENU MENU MENU MENU MENU  -->
<script>

    b_usuario.innerHTML = sessionStorage.NOME_USUARIO;

    function limparFormulario() {
        document.getElementById("form_postagem").reset();
    }

    function cadastrarEmpresa() {
        var dadosInput = {
            nome: input_nome_empresa.value,
            cnpj: input_cnpj_empresa.value,
            cep: input_cep_empresa.value,
            cidade: input_cidade_empresa.value,
            estado: input_estado_empresa.value,
            complemento: input_complemento_empresa.value
        }

        fetch(`/avisos/cadastrarEmpresa`, {
            method: "post",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify(dadosInput)
        }).then(function (resposta) {

            console.log("resposta: ", resposta);

            if (resposta.ok) {
                cadastrarEmpresaAdmin()
            } else if (resposta.status == 404) {
                window.alert("Deu 404!");
            } else {
                throw ("Houve um erro ao tentar realizar a postagem! Código da resposta: " + resposta.status);
            }
        }).catch(function (resposta) {
            console.log(`#ERRO: ${resposta}`);
        });

        return false;

    }
    var id = sessionStorage.ID_USUARIO
    function cadastrarEmpresaAdmin() {
        var dadosInput = {
            cnpj: input_cnpj_empresa.value
        }

        fetch(`/avisos/cadastrarEmpresaAdmin/${id}`, {
            method: "post",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify(dadosInput)
        }).then(function (resposta) {

            console.log("resposta: ", resposta);

            if (resposta.ok) {
                window.location = 'cadastro_empresa.html'
            } else if (resposta.status == 404) {
                window.alert("Deu 404!");
            } else {
                throw ("Houve um erro ao tentar realizar a postagem! Código da resposta: " + resposta.status);
            }
        }).catch(function (resposta) {
            console.log(`#ERRO: ${resposta}`);
        });

        return false;

    }


    function atualizarEmpresa() {
        fetch(`/avisos/atualizarEmpresa/${id}`).then(function (resposta) {
            if (resposta.ok) {
                if (resposta.status == 204) {
                    throw "Nenhum resultado encontrado!!";
                }

                resposta.json().then(function (resposta) {
                    console.log("Dados recebidos: ", JSON.stringify(resposta));
                    for (let i = 0; i < resposta.length; i++) {
                        var publicacao = resposta[i];
                        listaEmpresa.innerHTML += `

                        <li>
                    <div class="avatar">
                    <img src="./assets/icons/building.svg" alt="">
                </div>
                <div class="descrisao">
                    <span>                   
                        Nome fantasia: ${publicacao.nomeFantasia}
                    </span>
                    <span>
                        CNPJ: ${publicacao.cnpj}
                    </span>
                    <span>
                        CEP: ${publicacao.cep}
                    </span>
                    <span>                   
                        Cidade: ${publicacao.cidade}
                    </span>
                    <span>                   
                        Estado: ${publicacao.estado}
                    </span>
               
                    
                </div>
            </li>
        `
                    }

                });
            } else {
                throw ('Houve um erro na API!');
            }
        }).catch(function (resposta) {
            console.error(resposta);
        });
    }

</script>


<script>
    //deixar o menu toggle 
    let toggle = document.querySelector('.toggle');
    let navegacao = document.querySelector('.navegacao');
    let menu = document.querySelector('.menu');


    //Criando a função para quando clicar ativar e desativar
    toggle.onclick = function () {
        navegacao.classList.toggle('ativar');
        menu.classList.toggle('ativar');
    }
    navegacao.classList.toggle('ativar');
    menu.classList.toggle('ativar');
</script>



<!-- MODO ESCURO  MODO ESCURO  MODO ESCURO  MODO ESCURO  MODO ESCURO  MODO ESCURO  MODO ESCURO -->
<script>
    var clique = 1;


    // Mudando a frase ao clicar 
    function ModoClaro() {
        if (clique >= 13) {
            clique = 0;
        }
        if (clique % 2 == 1) {
            ModoEscuro.innerHTML = 'Modo Claro'
            clique += 1;

        } else {
            ModoEscuro.innerHTML = 'Modo Escuro'
            clique += 1;
        }
    }

    // 


    const body = document.querySelector("body");
    const modoEscuro = body.querySelector(".Modo");

    modoEscuro.addEventListener("click", () => {
        body.classList.toggle("Escuro");
    });

</script>

<script>
    var adicionar = 0;
    function Adicionar() {
        if (adicionar == 0) {
            adicionar3.classList = 'adicionar4'
            adicionar++;
            adicionar2.innerHTML = `                   
             <a href="#" >

<!--Imagem do ICONE DE ADICIONAR -->
<span class="icone"> <i class="uil uil-plus"></i> </span>
<span class="titulo"> Adicionar</span>
<span class="icone2"><i class="uil uil-angle-up"></i></span>

</a>`

        } else {
            adicionar3.classList = 'adicionar'
            adicionar = 0

            adicionar2.innerHTML = `                   
             <a href="#" >

<!--Imagem do ICONE DE ADICIONAR -->
<span class="icone"> <i class="uil uil-plus"></i> </span>
<span class="titulo"> Adicionar</span>
<span class="icone2"><i class="uil uil-angle-down"></i></span>

</a>`
        }
    }


    function cnpjPontos() {
        var cnpjz = input_cnpj_empresa.value;
        var Digito1 = cnpjz[0]
        var Digito2 = cnpjz[1]
        var Digito3 = cnpjz[2]
        var Digito4 = cnpjz[3]
        var Digito5 = cnpjz[4]
        var Digito6 = cnpjz[5]
        var Digito7 = cnpjz[6]
        var Digito8 = cnpjz[7]
        var Digito13 = cnpjz[12]
        var Digito14 = cnpjz[13]
        var cnpjInteiro = `${Digito1}${Digito2}.${Digito3}${Digito4}${Digito5}.${Digito6}${Digito7}${Digito8}/0001-${Digito13}${Digito14}`
        if (cnpjz.length == 14) {
            input_cnpj_empresa.value = `${cnpjInteiro}`
        }

    }

    function cepPontos() {
        var cepz = input_cep_empresa.value;
        var Digito1 = cepz[0]
        var Digito2 = cepz[1]
        var Digito3 = cepz[2]
        var Digito4 = cepz[3]
        var Digito5 = cepz[4]
        var Digito6 = cepz[5]
        var Digito7 = cepz[6]

        var cepInteiro = `${Digito1}${Digito2}${Digito3}${Digito4}-${Digito5}${Digito6}${Digito7}`
        if (cepz.length == 8) {
            input_cep_empresa.value = `${cepInteiro}`
        }

    }

    var modalzinho = document.querySelector("dialog")
    function modal() {
        modalzinho.showModal()
        modalzinho.classList = 'dialogzinho2'
    }

    function fechar() {
        modalzinho.close()
        modalzinho.classList = 'dialogzinho'

    }
</script>